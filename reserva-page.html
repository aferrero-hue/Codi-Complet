<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="assets/css/style.css" rel="stylesheet">
  <script src="assets/js/Calendar.js"></script>    
  <script
  src="https://code.jquery.com/jquery-3.3.1.min.js"
  integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
  crossorigin="anonymous"></script>
  <script src="assets/js/index.js"></script>  

  <title>Seleccionar Fecha y Hora</title>
</head>
<body>

<div class="calendar">
  <div>
    <button id="prevMonth" onclick="prevMonth()">Anterior</button>
    <span id="currentMonthYear"></span>
    <button id="nextMonth" onclick="nextMonth()">Siguiente</button>
  </div>
  <table id="calendarTable">
    <thead>
      <tr>
        <th>D</th>
        <th>L</th>
        <th>M</th>
        <th>M</th>
        <th>J</th>
        <th>V</th>
        <th>S</th>
      </tr>
    </thead>
    <tbody id="calendarBody">
    </tbody>
  </table>
  <div>
    <input type="date" id="selectedDate">
    <select id="hora">
      <option value="default"></option>
    </select>
    <button id="PutUSER" style="display: none;">Mostrar Selección</button>
  </div>
</div>

<script>
  //Aqui s'ha de fer una funció perque tingui accés API:
  //Principalment la validació de l'hora seleccionada: [PENDENT]
  function LetsPutUser(result){
    console.log("");
    //Una vegada s'han fet els cambis:
    window.location.reload();
  }
  //També una comprovació de les hores seleccionades: [PENDENT]
  document.addEventListener("DOMContentLoaded", function() {
    if (checkCookies()) {
      DefineUser();       
      GetSavedHours();
    }else{
      alert("no hay un registro men...");
      goingLogin();
    }
      //GetSavedHours();
  });
  function GetSavedHours(){
    var settings = {
          "url": "http://localhost:8000/GET/Dates", 
          "method": "GET",
          "timeout": 0,
      };

      $.ajax(settings).done(function (response) {
        console.log(response);
        setTakenDates(response);
      });
  }
  function SubmitHours(usuari, nextdate){
    console.log(nextdate);
    var settings = {
              "url": "http://localhost:8000/PUT/date/" + usuari, 
              "method": "PUT",
              "timeout": 0,
              "data": JSON.stringify({ "nextdate": nextdate }),
              "contentType": "application/json"
          };

      $.ajax(settings).done(function (response) {
        console.log(response);
      });

  }
</script>

</body>
</html>

